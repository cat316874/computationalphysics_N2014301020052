# Excercise_14

标签（空格分隔）： 计算物理

---

[TOC]

---
#Abstract
Here the particular case of waves on a string is considered. At the beginning, a solution for the wave equation in the ideal case is introduced and developed, that is, for a perfectly flexible and frictionless string. Only one initial Gaussian wave packet and two initial Gaussian wave packets are considered to show that the wave packets are unaffected by the collisions. Besides, Fourier analysis is applied in the spectral analysis to exam the waves on a string.

---
#Background
+ In physics, a wave is an oscillation accompanied by a transfer of energy that travels through a medium (space or mass). Frequency refers to the addition of time. Wave motion transfers energy from one point to another, which displace particles of the transmission medium–that is, with little or no associated mass transport. Waves consist, instead, of oscillations or vibrations (of a physical quantity), around almost fixed locations.
+ There are two main types of waves. Mechanical waves propagate through a medium, and the substance of this medium is deformed. Restoring forces then reverse the deformation. For example, sound waves propagate via air molecules colliding with their neighbors. When the molecules collide, they also bounce away from each other (a restoring force). This keeps the molecules from continuing to travel in the direction of the wave.
+ The second main type, electromagnetic waves, do not require a medium. Instead, they consist of periodic oscillations of electrical and magnetic fields originally generated by charged particles, and can therefore travel through a vacuum. These types vary in wavelength, and include radio waves, microwaves, infrared radiation, visible light, ultraviolet radiation, X-rays and gamma rays.
Waves are described by a wave equation which sets out how the disturbance proceeds over time. The mathematical form of this equation varies depending on the type of wave. Further, the behavior of particles in quantum mechanics are described by waves. In addition, gravitational waves also travel through space, which are a result of a vibration or movement in gravitational fields.
+ A wave can be transverse, where a disturbance creates oscillations that are perpendicular to the propagation of energy transfer, or longitudinal: the oscillations are parallel to the direction of energy propagation. While mechanical waves can be both transverse and longitudinal, all electromagnetic waves are transverse in free space.

---
![](https://github.com/Rob1nTian/computationalphysics_N2014301020052/blob/master/Excercise_12/1.jpg)

---
Suppose the total length of the string is 1 unit.
For Gaussian Wavepackte, the displacement of the string can be written as
![](https://github.com/Rob1nTian/computationalphysics_N2014301020052/blob/master/Excercise_12/2.gif)

---
+ where the parameters ![](https://github.com/Rob1nTian/computationalphysics_N2014301020052/blob/master/Excercise_12/3.gif) influence the width and center of the wavepacket respectively.
+ A more realistic initial wavepacket is composed of two straight lines, that is:
![](https://github.com/Rob1nTian/computationalphysics_N2014301020052/blob/master/Excercise_12/4.gif)

---
#Main Text
The central equation of wave motion is  
![]( http://latex.codecogs.com/gif.latex?%5Cfrac%7B%5Cpartial%5E2%20y%7D%7B%5Cpartial%20t%5E2%7D%3Dc%5E2%5Cfrac%7B%5Cpartial%5E2%20y%7D%7B%5Cpartial%20x%5E2%7D)  
where ![]( http://latex.codecogs.com/gif.latex?c%5E2%3D%5Cfrac%7BT%7D%7B%5Crho%20%7D) is the ratio of the tension in the string to the density per length.  
To solve the time-dependent solution ![]( http://latex.codecogs.com/gif.latex?y%28x%2Ct%29), the wave equation should be attacked with rather different numerical treatments than those employed in the work with Laplace’s equation. The numerical approach can be written as follows.  
The variables are treated as discrete ones as ![]( http://latex.codecogs.com/gif.latex?x%3Di%5CDelta%20x%2Ct%3Dn%5CDelta%20t). The displacement of the string is a function of i and n, that is, ![]( http://latex.codecogs.com/gif.latex?y%28i%2Cn%29%5Cequiv%20y%28x%3Di%5CDelta%20x%2Ct%3Dn%5CDelta%20t%29). Inserting the expression for the second partial derivative, the wave equation can be rewritten as  
![]( http://latex.codecogs.com/gif.latex?%5Cfrac%7By%28i%2Cn&plus;1%29&plus;y%28i%2Cn-1%29-2y%28i%2Cn%29%7D%7B%28%5CDelta%20t%29%5E2%7D%5Capprox%20c%5E2%5B%5Cfrac%7By%28i&plus;1%2Cn%29&plus;y%28i-1%2Cn%29-2y%28i%2Cn%29%7D%7B%28%5CDelta%20x%29%5E2%7D%5D)  
Rearranging the above equation, we have  
![]( http://latex.codecogs.com/gif.latex?y%28i%2Cn&plus;1%29%3D2%281-r%5E2%29y%28i%2Cn%29-y%28i%2Cn-1%29&plus;r%5E2%5By%28i&plus;1%2Cn%29&plus;y%28i-1%2Cn%29%5D)  
Where ![]( http://latex.codecogs.com/gif.latex?r%5Cequiv%20c%5CDelta%20t/%5CDelta%20x). Thus if we know the string configuration as time steps n and n-1, the configuration at step n+1 can be calculated.
The boundary condition is ![]( http://latex.codecogs.com/gif.latex?y%280%2Cn%29%3Dy%28M%2Cn%29%5Cequiv%200) and the initial condition is ![]( http://latex.codecogs.com/gif.latex?y%28i%2C0%29%3Dy_o%28i%29).  

---
Suppose the initial wavepacket is ![](http://latex.codecogs.com/gif.latex?y_o%28x%29%3Dexp%5B-1000%5Ctimes%28x-x_%7Bexcite%7D%29%5E2%5D). And the total length of the string is 1 unit.  
When ![](http://latex.codecogs.com/gif.latex?x_%7Bexcite%7D%3D0.5) and ![](http://latex.codecogs.com/gif.latex?x_%7Bobserve%7D%3D0.05)  
![](https://github.com/Rob1nTian/computationalphysics_N2014301020052/blob/master/Excercise_12/5.png)  

When ![](http://latex.codecogs.com/gif.latex?x_%7Bexcite%7D%3D0.5) and ![](http://latex.codecogs.com/gif.latex?x_%7Bobserve%7D%3D0.1)  
![](https://github.com/Rob1nTian/computationalphysics_N2014301020052/blob/master/Excercise_12/6.png)  

When ![](http://latex.codecogs.com/gif.latex?x_%7Bexcite%7D%3D0.5) and ![](http://latex.codecogs.com/gif.latex?x_%7Bobserve%7D%3D0.05%2C0.1%2C0.2%2C0.3), their corresponding power spectrum is  
![](https://github.com/Rob1nTian/computationalphysics_N2014301020052/blob/master/Excercise_12/7.png)  

When ![](http://latex.codecogs.com/gif.latex?x_%7Bexcite%7D%3D0.45) and ![](http://latex.codecogs.com/gif.latex?x_%7Bobserve%7D%3D0.05%2C0.1%2C0.2%2C0.3), their corresponding power spectrum is  
![](https://github.com/Rob1nTian/computationalphysics_N2014301020052/blob/master/Excercise_12/8.png)  

because ![](http://latex.codecogs.com/gif.latex?%5Clambda%20f%3Dc%2C%5Clambda%20%3D2L/m%2Cm%5Cin%20N), we have the possible frequencies as ![](http://latex.codecogs.com/gif.latex?f%3Dmc/%282L%29%3D150mHz). This explains why the peaks in the spectral analysis in the above figures occur at regularly spaced frequencies. Each of the peaks correspond to one value of interger m. But some frequancies are missing and this can be traced to the operation of Fourier Transformation.  
Besides, the symmetry of the initial wavepacket can cause certain frequencies to be supressed. The power spectrum of ![](http://latex.codecogs.com/gif.latex?x_%7Bexcite%7D%3D0.45) can illustrate this clearly.  

Code here:
```python
import matplotlib.pyplot as plt
import math
import numpy as np
from matplotlib import animation

delta_x, c ,r , k = 0.001, 300 , 1 , 1000
delta_t=delta_x/c
T=0.04
N=int(T*c/delta_x)
t=np.linspace(0,T,N+1)

def next_step(y_previous,y_current):
    y_next=[0]
    c1,c2=2*(1-r**2),r**2
    for i in range(1,len(y_current)-1):
        y_next.append(c1*y_current[i]-y_previous[i]+c2*(y_current[i-1]+y_current[i+1]))
    y_next.append(0)
    return y_next

def initial_Gaussian(x_excite):#initialize or excite the string in some point in the gaussian way
    y_initial=[]           
    for i in range(1+int(1./delta_x)):
        y_initial.append(math.exp(-k*(i*delta_x-x_excite)**2))
    return y_initial

def initial_real(x_excite):#initialize or excite the string in some point in the real way
    y_initial=[]
    for i in range(int(x_excite/delta_x)):
        y_initial.append(i*delta_x/x_excite)
    for i in range(int(x_excite/delta_x),1+int(1./delta_x)):
        y_initial.append((i*delta_x-1.)/(x_excite-1))
    return y_initial

def motion_of_a_point(x_observe,x_excite):
    y_initial=initial_real(x_excite) #this can be changed accrodingly
    y_observe=[]                  #calculate the displacement at x=0.05 or y(i=I,n)
    I=int(x_observe/delta_x)
    y0=y_initial
    y1=y_initial
    y_observe.append(y1[I])
    for i in range(N):
        y2=next_step(y0,y1)
        y0,y1=y1,y2
        y_observe.append(y1[I])
    return y_observe


#plot
x_observe_list,x_ex=[0.05,0.1,0.2,0.3],0.45


x_ob=x_observe_list[0]
yx=motion_of_a_point(x_ob,x_ex)
ps=abs(np.fft.rfft(yx))**2
freq= np.linspace(0, c/delta_x/2, len(ps))

plt.subplot(1,2,1)
plt.plot(t,yx)
plt.title('String Signal versus Time')
plt.xlabel('time(s)')
plt.ylabel('Signal(arbitrary units)')
#plt.text(0.,0.4,r'R Wavepacket,$y_0(x)=exp[-1000\times(x-%s)^2]$'%x_ex+'\n$x_{observe}=%s$'%x_ob)
plt.text(0,0.12,'Real Wavepacket of Two Straight Lines')
plt.xlim(0,T)

plt.subplot(1,2,2)
plt.plot(freq,ps)
plt.xlim(0,3000)
plt.xlabel('Frequency(Hz)')
plt.ylabel('Power')
plt.title('Power spectrum')
#plt.text(1500,200000,r'Gaussian Wavepacket'+'\n$y_0(x)=exp[-1000*(x-%s)^2]$'%x_ex+'\n$x_{observe}=%s$'%x_ob)
plt.text(1500,200000,r'Real Wavepacket'+'\n$x_{excite}=$%s'%x_ex+'\n$x_{observe}=%s$'%x_ob)


plt.show()
```

---
Consider the power spectrum when the initial wave form is triangle:
![](https://github.com/Rob1nTian/computationalphysics_N2014301020052/blob/master/Excercise_12/9.png) 
![](https://github.com/Rob1nTian/computationalphysics_N2014301020052/blob/master/Excercise_12/10.png)
We can see that the peak of the wave are decreasing as the frequency is increasing.
![](https://github.com/Rob1nTian/computationalphysics_N2014301020052/blob/master/Excercise_12/11.png) 
![](https://github.com/Rob1nTian/computationalphysics_N2014301020052/blob/master/Excercise_12/12.png) 
This time the symmetry of the initial wave forms is not good as the first situation, so there are more frequency peak.

Code here:
```python
from __future__ import division
import numpy as np
from copy import deepcopy
from cmath import *
import matplotlib.pyplot as plt

x = np.linspace(0,1,101)

y_now = np.exp(-1000*(x-0.5)**2) 
y_now[0] = 0
y_now[-1] = 0

y_before = deepcopy(y_now)
y_after = np.zeros(101)
disp = [y_now[5]]
t = [0]

for j in range(2**(10)-1):

    for i in range(101):
        if i== 0 or i== 100:
            y_after[i] = 0
        else:
            y_after[i] = - y_before[i] + y_now[i+1] + y_now[i-1]

    y_before = deepcopy(y_now)
    y_now = deepcopy(y_after)
    disp.append(y_now[5])
    t.append((j+1)*10**(-4)/3)

disp_fft = np.fft.fft(disp)
disp_power = []
frequency = []
for i in range(1024):
    if i==0:
        disp_power.append(abs(disp_fft[i]))
        f = 0
        frequency.append(f)
    else:
        disp_power.append(abs(disp_fft[i]))
        T = 1024*10**(-4)/(3*i)
        f = 1/T
        frequency.append(f)

plt.plot(frequency, disp_power)

plt.xlabel('Frequency(Hz)')
plt.ylabel('Power(arbitrary units)')
plt.title('Power spectrum')
plt.xlim(0,3000)

plt.show()
```

---
```python
from __future__ import division
import numpy as np
from copy import deepcopy
from cmath import *
import matplotlib.pyplot as plt

x = np.linspace(0,1,101)

y_now = np.zeros(101)
for i in range(101):
    if i<=50:
        y_now[i] = (1/50)*i
    else:
        y_now[i] = -(1/50)*i + 2
y_now[0] = 0
y_now[-1] = 0

y_before = deepcopy(y_now)
y_after = np.zeros(101)
disp = [y_now[5]]
t = [0]

for j in range(2**(10)-1):

    for i in range(101):
        if i== 0 or i== 100:
            y_after[i] = 0
        else:
            y_after[i] = - y_before[i] + y_now[i+1] + y_now[i-1]

    y_before = deepcopy(y_now)
    y_now = deepcopy(y_after)
    disp.append(y_now[5])
    t.append((j+1)*10**(-4)/3)

disp_fft = np.fft.fft(disp)
disp_power = []
frequency = []
for i in range(1024):
    if i==0:
        disp_power.append(abs(disp_fft[i]))
        f = 0
        frequency.append(f)
    else:
        disp_power.append(abs(disp_fft[i]))
        T = 1024*10**(-4)/(3*i)
        f = 1/T
        frequency.append(f)

plt.plot(frequency, disp_power)

plt.xlabel('Frequency(Hz)')
plt.ylabel('Power(arbitrary units)')
plt.title('Power spectrum')
plt.xlim(0,3000)

plt.show()
```

---
#Acknowledgement
+ Thanks to the author for the systematic guidence.
+ Thanks to Wikipedia
+ Thanks to Junyi Shangguan and Yuqiao Wu.



